import folium
from mapa_basededatos import usuario
def hacer_mapa(coordenada_centrar,Id,acceso):
    
    e=usuario.query.get(Id)
    if acceso==1:
        estado_sesion="cerrar session"
    else:
        estado_sesion="iniciar session"

    
    
    mymap = folium.Map(
        location=coordenada_centrar,
        tiles="OpenStreetMap",
        zoom_start=10
        );
    feature_group = folium.FeatureGroup(name="lago Chinchaicocha")
    folium.Marker(location=coordenada_centrar).add_to(feature_group)
    mymap.add_child(feature_group)
    mymap.add_child(folium.map.LayerControl())

    
    html=("""
          <h1 class='text-center'> SISTEMA DE GESTION DE RIESGOS</h1>
          <h2 class='text-center'> vereda granizal</h2>
          <h3 class='text-center'> vereda granizal</h3>
          


          <div style='text-align: center; '>
          
          <a href='/pagina2'    class='btn btn-primary active' aria-current='page'>"""+(estado_sesion)+"""</a>
          
          <a href='loggin.html' class='btn btn-primary'>Link</a>
          <a href='#'           class='btn btn-primary'>Link</a>
        
          </div>
          
          <script>
               function finME(){
            var output= document.getElementById('map');
            if(navigator.geolocation){
                output.innerHTML ="<p>soporta</p>"; 
            }else{
                output.innerHTML ="<p> no soporta</p>"; 
            }
            function localizacion(posicion){
                var latitude= posicion.coords.latitude;
                var longitude=posicion.coords.longitude;
                output.innerHTML ="<p> latitud :"+latitude+"<br> longitud :"+longitude+"</p>"; 
                let userInfo={
                "latitude": latitude ; 
                }
                
                const request = new XMLHttpRequest()
                request.open("POST","/coordenadas/${JSON.stringify(userInfo)}")
                request.onload=() =>{
                    const.flaskMessage=request.responseText
                    console.log(flaskMessage)
                }
            }
            function error(posicion){
                output.innerHTML ="<p> erro </p>"; 
                
            }
            navigator.geolocation.getCurrentPosition(localizacion,error);
        }
           </script>
          
          
          
          
          """
          )
    # envio html
    titulo=folium.Element(html);
    mymap.get_root().html.add_child(titulo);
    #fin
    mymap.save('tesis-env/Lib/site-packages/templates/index.html')  
